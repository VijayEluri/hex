<project name="hex" default="build">
    <scriptdef name="run-all" language="JavaScript">
        <attribute name="target"/>
        <![CDATA[

        var builds = new Array("util", "binary", "interpreter", "anno", "viewer", "formats", "main", "launcher");
        var target = attributes.get("target");
        for (i = 0; i < builds.length; i++) {
            var task = project.createTask("ant");
            task.setDir(new java.io.File(builds[i]));
            if (target != null) {
                task.setTarget(target);
            }
            task.perform();
        }
 
        ]]>
    </scriptdef>

    <target name="build" description="Runs each build in series.">
        <run-all/>
    </target>

    <target name="test" description="Tests each build in series.">
        <run-all target="test"/>
    </target>

    <target name="clean" description="Cleans generated files from each build">
        <run-all target="clean"/>
    </target>
</project>
